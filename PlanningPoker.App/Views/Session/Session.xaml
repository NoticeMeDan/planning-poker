<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:controls="clr-namespace:DLToolkit.Forms.Controls;assembly=DLToolkit.Forms.Controls.FlowListView"
    x:Class="PlanningPoker.App.Views.Session.Session"
    Title="Title"
>
    <StackLayout>
        <!-- Item of the current item -->
        <Label Text="Item title"/>

        <!-- List over the players who have played a card -->
        <controls:FlowListView
            FlowColumnCount="6" SeparatorVisibility="None" HasUnevenRows="false"
            FlowItemsSource="{Binding Players, Mode=Default}"
            IsPullToRefreshEnabled="true"
            RefreshCommand="{Binding LoadPlayersCommand}"
            IsRefreshing="{Binding IsBusy, Mode=OneWay}"
            SelectionMode="None"
            >

            <controls:FlowListView.FlowColumnTemplate>
                <DataTemplate>
                    <Label HorizontalOptions="Fill" VerticalOptions="Fill"
                           XAlign="Center" YAlign="Center" Text="{Binding Nickname}"/>
                </DataTemplate>
            </controls:FlowListView.FlowColumnTemplate>

        </controls:FlowListView>

        <!-- List over the chosen estimate by players -->
        <controls:FlowListView
            FlowColumnCount="6" SeparatorVisibility="None" HasUnevenRows="false"
            FlowItemsSource="{Binding Votes}"
            IsPullToRefreshEnabled="true"
            RefreshCommand="{Binding LoadVotesCommand}"
            IsRefreshing="{Binding IsBusy, Mode=OneWay}"
            SelectionMode="None"
        >
            <controls:FlowListView.FlowColumnTemplate>
                <DataTemplate>
                    <StackLayout>
                        <Label HorizontalOptions="Fill" VerticalOptions="Fill"
                               XAlign="Center" YAlign="Center" Text="{Binding UserId, Mode=TwoWay}"/>
                        <Label HorizontalOptions="Fill" VerticalOptions="Fill"
                               XAlign="Center" YAlign="Center" Text="{Binding Estimate, Mode=TwoWay}"/>
                    </StackLayout>
                </DataTemplate>
            </controls:FlowListView.FlowColumnTemplate>
        </controls:FlowListView>

        <!-- Available cards to play-->
        <Grid

            VerticalOptions="End"
            Margin="20"
            ColumnSpacing="5"
            >
            <Grid.RowDefinitions>
                <RowDefinition Height="100" />
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="55" />
                <ColumnDefinition Width="55" />
                <ColumnDefinition Width="55" />
                <ColumnDefinition Width="55" />
                <ColumnDefinition Width="55" />
                <ColumnDefinition Width="55" />
            </Grid.ColumnDefinitions>

            <Button Text="1" Grid.Row="0" Grid.Column="0" Command="{Binding SendVoteCommand}" CommandParameter="1"/>
            <Button Text="3" Grid.Row="0" Grid.Column="1" Command="{Binding SendVoteCommand}" CommandParameter="3"/>
            <Button Text="5" Grid.Row="0" Grid.Column="2" Command="{Binding SendVoteCommand}" CommandParameter="5"/>
            <Button Text="8" Grid.Row="0" Grid.Column="3" Command="{Binding SendVoteCommand}" CommandParameter="8"/>
            <Button Text="13" Grid.Row="0" Grid.Column="4" Command="{Binding SendVoteCommand}" CommandParameter="13"/>
            <Button Text="20" Grid.Row="0" Grid.Column="5" Command="{Binding SendVoteCommand}" CommandParameter="20"/>
        </Grid>

        <!-- Buttons for Play Nitpicker, Re-vote and Next item -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Button Text="Play Nitpicker" Grid.Row="0" Grid.Column="0" Clicked="OnNitpicker_Clicked" />
            <Button Text="Re-vote" Grid.Row="0" Grid.Column="1" Clicked="OnReVote_Clicked" />
            <Button Text="Next Item" Grid.Row="0" Grid.Column="2" Clicked="OnNextItem_Clicked" />
        </Grid>

    </StackLayout>
</ContentPage>
